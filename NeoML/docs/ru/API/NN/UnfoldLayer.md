# Класс CUnfoldLayer

<!-- TOC -->

- [Класс CUnfoldLayer](#класс-cunfoldlayer)
    - [Настройки](#настройки)
        - [Размеры фильтров](#размеры-фильтров)
        - [Шаг свертки](#шаг-свертки)
        - [Дополнительные столбцы и колонки (padding)](#дополнительные-столбцы-и-колонки-padding)
        - [Разреженная свертка](#разреженная-свертка)
    - [Обучаемые параметры](#обучаемые-параметры)
    - [Входы](#входы)
    - [Выходы](#выходы)

<!-- /TOC -->

Класс реализует слой, извлекающий из набора изображений данные, попадающие под фильтры свертки с заданными параметрами.

## Настройки

### Размеры фильтров

```c++
void SetFilterHeight( int filterHeight );
void SetFilterWidth( int filterWidth );
```

Устанавливает размеры фильтров.

### Шаг свертки

```c++
void SetStrideHeight( int strideHeight );
void SetStrideWidth( int strideWidth );
```

Устанавливает шаг свёртки. По умолчанию оба значения равны `1`.

### Дополнительные столбцы и колонки (padding)

```c++
void SetPaddingHeight( int paddingHeight );
void SetPaddingWidth( int paddingWidth );
```

Устанавливает количество дополнительных строк и/или столбцов, заполненных нулями, которые будут добавлены по краям изображения. Например, при `SetPaddingWidth( 1 );` к изображению будут добавлены 2 колонки (по одной слева и справа). По умолчанию равны `0`.

### Разреженная свертка

```c++
void SetDilationHeight( int dilationHeight );
void SetDilationWidth( int dilationWidth );
```

Настраивает использование "разреженных" сверток. При разреженной свёртке соседние пиксели фильтра сворачивают не соседние пиксели исходного изображения, а пиксели на расстоянии `dilation`. По умолчанию эти настройки равны `1`, что соответствует неразреженной свертке.

## Обучаемые параметры

Слой не имеет обучаемых параметров.

## Входы

На единственный вход подется блоб с набором изображений, из которых будут извлечены данные. Размеры блоба:

- `BatchLength * BatchWidth * ListSize` - количество изображений в наборе;
- `Height` - высота изображений;
- `Width` - ширина изображений;
- `Depth * Channels` - количество каналов у изображений.

## Выходы

Единственный выход содержит результат операции, следующего размера:

- `BatchLength` равен `BatchLength` входа;
- `BatchWidth` равен `BatchWidth` входа;
- `ListSize` равен `ListSize` входа;
- `Height` равен произведению высоты и ширины результата свертки, где высота результата свертки равна `(2 * PaddingHeight + Height - (1 + DilationHeight * (FilterHeight - 1)))/StrideHeight + 1`, а ширина равна `(2 * PaddingWidth + Width - (1 + DilationWidth * (FilterWidth - 1)))/StrideWidth + 1`;
- `Width` равен `1`;
- `Depth` равен `1`;
- `Channels` равен `Channels` входа, домноженному на `filterHeight * filterWidth`.
